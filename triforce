#!/usr/bin/env python

# for each config file
#   for each sysenv
#     create the sysenv if it doesn't exist
#     gather all requirements to install and their url and all symlinks
#     pip install the requirements
#     update/create all the symlinks

import os
import sys
import yaml

config_files = sys.argv[1:]

for config_file in config_files:
    with open(config_file) as config_file_pointer:
        config = yaml.load(config_file_pointer)
        urls = []
        symlinks = []
        for sysvenv in config.values():
            for program, options in sysvenv.items():
                try:
                    urls.append(options['url'])
                except KeyError:
                    urls.append(program)
                try:
                    symlinks.extend(options['symlink'])
                except KeyError:
                    symlinks.append(program)
    for _ in config_file, config, sysvenv, urls, symlinks:
        print(_)
